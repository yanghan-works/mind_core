---
tags: 
alias: 
date: 2025-09-02 07:23
---
# Python pip 核心笔记

  

## 1. pip 简介

  

**pip** (Pip Installs Packages) 是 Python 的标准包管理工具，用于安装和管理 Python 包。

  

### 1.1 基本概念

- **包 (Package)**: 可重用的 Python 代码模块

- **PyPI**: Python Package Index，官方包仓库

- **虚拟环境**: 隔离的 Python 环境，避免包冲突

  

## 2. pip 安装与升级

  

### 2.1 检查 pip 版本

```bash

pip --version

pip -V

```

  

### 2.2 升级 pip

```bash

# Windows

python -m pip install --upgrade pip

  

# Linux/macOS

pip install --upgrade pip

```

  

### 2.3 安装 pip (如果未安装)

```bash

python -m ensurepip --upgrade

```

  

## 3. 包安装命令

  

### 3.1 基本安装

```bash

# 安装最新版本

pip install package_name

  

# 安装指定版本

pip install package_name==1.2.3

  

# 安装版本范围

pip install "package_name>=1.0,<2.0"

pip install "package_name~=1.2.0"  # 兼容版本

```

  

### 3.2 从不同源安装

```bash

# 从 PyPI 安装 (默认)

pip install requests

  

# 从 Git 仓库安装

pip install git+https://github.com/user/repo.git

  

# 从本地路径安装

pip install ./local_package

pip install /path/to/package

  

# 从压缩包安装

pip install package.tar.gz

pip install package.whl

```

  

### 3.3 安装选项

```bash

# 用户级安装 (不需要管理员权限)

pip install --user package_name

  

# 强制重新安装

pip install --force-reinstall package_name

  

# 不安装依赖

pip install --no-deps package_name

  

# 预发布版本

pip install --pre package_name

  

# 指定安装目录

pip install --target /path/to/dir package_name

```

  

## 4. 包管理命令

  

### 4.1 查看已安装包

```bash

# 列出所有包

pip list

  

# 列出过时包

pip list --outdated

  

# 显示包详细信息

pip show package_name

  

# 显示包依赖树

pip show --verbose package_name

```

  

### 4.2 搜索包

```bash

# 搜索包 (注意：PyPI 已禁用搜索)

pip search package_name

```

  

### 4.3 升级包

```bash

# 升级单个包

pip install --upgrade package_name

  

# 升级所有包 (需要额外工具)

pip list --outdated --format=freeze | grep -v '^\-e' | cut -d = -f 1 | xargs -n1 pip install -U

```

  

### 4.4 卸载包

```bash

# 卸载单个包

pip uninstall package_name

  

# 卸载多个包

pip uninstall package1 package2

  

# 批量卸载 (从文件)

pip uninstall -r requirements.txt

  

# 确认卸载

pip uninstall -y package_name

```

  

## 5. 依赖管理

  

### 5.1 requirements.txt

```bash

# 生成依赖文件

pip freeze > requirements.txt

  

# 安装依赖文件中的包

pip install -r requirements.txt

  

# 升级依赖文件中的包

pip install -r requirements.txt --upgrade

```

  

### 5.2 requirements.txt 格式示例

```text

# 精确版本

Django==4.2.0

  

# 版本范围

requests>=2.25.0,<3.0.0

  

# 兼容版本

numpy~=1.21.0

  

# 最小版本

matplotlib>=3.0

  

# Git 仓库

git+https://github.com/user/repo.git@v1.0

  

# 本地包

-e ./local_package

  

# 注释

# 这是一个注释行

```

  

## 6. 虚拟环境与 pip

  

### 6.1 创建虚拟环境

```bash

# 使用 venv

python -m venv myenv

  

# 使用 virtualenv

virtualenv myenv

```

  

### 6.2 激活虚拟环境

```bash

# Windows

myenv\Scripts\activate

  

# Linux/macOS

source myenv/bin/activate

```

  

### 6.3 在虚拟环境中使用 pip

```bash

# 激活环境后直接使用

pip install package_name

  

# 或指定 Python 解释器

myenv/Scripts/python -m pip install package_name

```

  

## 7. pip 配置

  

### 7.1 配置文件位置

- **Windows**: `%APPDATA%\pip\pip.ini`

- **Linux/macOS**: `~/.pip/pip.conf`

- **全局配置**: `/etc/pip.conf` (Linux/macOS)

  

### 7.2 配置示例

```ini

[global]

index-url = https://pypi.tuna.tsinghua.edu.cn/simple

trusted-host = pypi.tuna.tsinghua.edu.cn

timeout = 60

  

[install]

trusted-host = pypi.tuna.tsinghua.edu.cn

```

  

### 7.3 临时使用镜像源

```bash

# 清华源

pip install -i https://pypi.tuna.tsinghua.edu.cn/simple package_name

  

# 阿里源

pip install -i https://mirrors.aliyun.com/pypi/simple package_name

  

# 豆瓣源

pip install -i https://pypi.douban.com/simple package_name

```

  

## 8. 高级功能

  

### 8.1 pip cache

```bash

# 查看缓存信息

pip cache info

  

# 列出缓存文件

pip cache list

  

# 清除缓存

pip cache purge

  

# 删除特定包缓存

pip cache remove package_name

```

  

### 8.2 pip check

```bash

# 检查依赖冲突

pip check

```

  

### 8.3 pip download

```bash

# 下载包但不安装

pip download package_name

  

# 下载到指定目录

pip download -d /path/to/dir package_name

  

# 下载依赖文件中的所有包

pip download -r requirements.txt

```

  

### 8.4 pip wheel

```bash

# 构建 wheel 包

pip wheel package_name

  

# 构建到指定目录

pip wheel -w /path/to/dir package_name

```

  

## 9. 常用镜像源

  

### 9.1 国内镜像源

| 名称 | URL |

|------|-----|

| 清华大学 | https://pypi.tuna.tsinghua.edu.cn/simple |

| 阿里云 | https://mirrors.aliyun.com/pypi/simple |

| 中科大 | https://pypi.mirrors.ustc.edu.cn/simple |

| 豆瓣 | https://pypi.douban.com/simple |

| 华为云 | https://mirrors.huaweicloud.com/repository/pypi/simple |

  

### 9.2 配置多个镜像源

```ini

[global]

index-url = https://pypi.tuna.tsinghua.edu.cn/simple

extra-index-url = https://mirrors.aliyun.com/pypi/simple

                  https://pypi.douban.com/simple

```

  

## 10. 故障排除

  

### 10.1 常见错误及解决方案

  

#### 权限错误

```bash

# 使用 --user 参数

pip install --user package_name

  

# 或使用虚拟环境

python -m venv myenv

myenv\Scripts\activate

pip install package_name

```

  

#### 网络超时

```bash

# 增加超时时间

pip install --timeout 300 package_name

  

# 使用国内镜像

pip install -i https://pypi.tuna.tsinghua.edu.cn/simple package_name

```

  

#### SSL 证书错误

```bash

# 信任主机

pip install --trusted-host pypi.org --trusted-host pypi.python.org package_name

  

# 或在配置文件中添加 trusted-host

```

  

### 10.2 调试选项

```bash

# 详细输出

pip install -v package_name

  

# 更详细输出

pip install -vv package_name

  

# 最详细输出

pip install -vvv package_name

  

# 显示安装过程

pip install --progress-bar pretty package_name

```

  

## 11. 最佳实践

  

### 11.1 项目依赖管理

1. **始终使用虚拟环境**

2. **固定依赖版本** (`pip freeze > requirements.txt`)

3. **区分开发和生产依赖**

4. **定期更新依赖**

  

### 11.2 requirements 文件组织

```text

# requirements.txt - 生产依赖

Django==4.2.0

psycopg2-binary==2.9.5

  

# requirements-dev.txt - 开发依赖

-r requirements.txt

pytest==7.2.0

black==23.1.0

flake8==6.0.0

```

  

### 11.3 安全考虑

```bash

# 检查已知漏洞

pip audit

  

# 安装时验证哈希

pip install --require-hashes -r requirements.txt

```

  

## 12. pip 工具生态

  

### 12.1 相关工具

- **pipenv**: 高级包管理工具

- **poetry**: 现代依赖管理

- **pip-tools**: pip 工作流增强

- **pipdeptree**: 依赖树可视化

  

### 12.2 pipenv 快速对比

```bash

# pip + venv

python -m venv myenv

myenv\Scripts\activate

pip install requests

pip freeze > requirements.txt

  

# pipenv

pipenv install requests

pipenv shell

```

  

## 13. 常用命令速查

  

### 13.1 日常操作

```bash

# 安装

pip install package_name

  

# 升级

pip install --upgrade package_name

  

# 卸载

pip uninstall package_name

  

# 列出包

pip list

  

# 包信息

pip show package_name

  

# 生成依赖

pip freeze > requirements.txt

  

# 安装依赖

pip install -r requirements.txt

```

  

### 13.2 环境管理

```bash

# 创建环境

python -m venv venv

  

# 激活环境 (Windows)

venv\Scripts\activate

  

# 激活环境 (Linux/macOS)

source venv/bin/activate

  

# 退出环境

deactivate

```

  

## 14. 性能优化

  

### 14.1 加速安装

```bash

# 使用缓存

pip install --cache-dir /path/to/cache package_name

  

# 并行下载

pip install --use-feature=parallel-download package_name

  

# 使用 wheel

pip install --only-binary=all package_name

```

  

### 14.2 减少网络请求

```bash

# 离线安装

pip install --no-index --find-links /path/to/wheels package_name

  

# 不检查依赖

pip install --no-deps package_name

```

  

---

  

## 总结

  

pip 是 Python 生态系统的核心工具，掌握其基本用法和高级特性对 Python 开发至关重要。建议：

  

1. **熟练掌握基本命令**：install, uninstall, list, show

2. **善用虚拟环境**：避免包冲突

3. **规范依赖管理**：使用 requirements.txt

4. **配置镜像源**：提高下载速度

5. **了解高级功能**：cache, wheel, audit 等

  

通过合理使用 pip，可以大大提高 Python 项目的开发效率和可维护性。