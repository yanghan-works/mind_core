`sed` (Stream Editor)，流编辑器。它并非一个交互式编辑器，而是一把命令行中的文本手术刀，逐行处理数据流，精准、高效，用完即走。

### 一、基本式 · 命令骨架 (Basic Formula)

理解 `sed` 的核心在于其工作流：**读取一行 -> 执行命令 -> 输出结果 -> 重复**。

**`sed [选项] '地址 命令' 文件名`**

- **地址 (Address):** 可选，用于指定要操作的行。若省略，则对所有行执行命令。
    
- **命令 (Command):** 要执行的操作，如替换、删除等。
    

### 二、地址 · 精准定位 (Targeting with Addresses)

地址决定了命令在“何处”生效。

|        |             |                         |
| ------ | ----------- | ----------------------- |
| **类型** | **语法**      | **释义**                  |
| **行号** | `n`         | 只对第 `n` 行操作             |
|        | `$`         | 只对最后一行操作                |
| **范围** | `n,m`       | 对从 `n` 到 `m` 行的范围操作     |
|        | `n,$`       | 对从 `n` 行到最后一行操作         |
|        | `n,+x`      | 对从 `n` 行开始的下 `x` 行操作    |
| **模式** | `/pattern/` | 对匹配 `pattern` 正则表达式的行操作 |

### 三、命令 · 核心八法 (Core Commands)

命令是 `sed` 的灵魂，决定了它“做什么”。

|   |   |   |
|---|---|---|
|**命令**|**语法**|**释义**|
|**替换**|`s/旧/新/标志`|**最核心的命令**。查找并替换。`标志`见下文。|
|**删除**|`d`|删除匹配的行。|
|**打印**|`p`|打印匹配的行。通常与 `-n` 选项配合使用。|
|**追加**|`a \文本`|在匹配行的**后面**追加新行，内容为“文本”。|
|**插入**|`i \文本`|在匹配行的**前面**插入新行，内容为“文本”。|
|**更改**|`c \文本`|将匹配的行**整行替换**为“文本”。|
|**读文件**|`r 文件名`|将指定文件的内容读入并追加到匹配行之后。|
|**写文件**|`w 文件名`|将匹配行的内容写入到指定文件中。|

#### `s` 命令的标志 (Flags for 's')

- `g` (Global): 替换行内所有匹配项，而不仅仅是第一个。
    
- `i` (Ignore Case): 忽略大小写。
    
- `N`: 数字，表示只替换第 N 个匹配项。
    

### 四、选项 · 神通加持 (Power-up Options)

选项为 `sed` 命令提供全局性的能力。

|   |   |
|---|---|
|**选项**|**释义**|
|`-n`|**静默模式 (Silent)**。取消默认输出。若无此项，`sed` 会输出所有行。常与 `p` 命令配合，实现“只打印我想要的”。|
|`-i`|**原地编辑 (In-place)**。直接修改文件内容，而非打印到标准输出。**此为大杀器，使用需谨慎**。建议使用 `-i.bak` 创建备份。|
|`-e`|**多点编辑 (Expression)**。允许在同一命令中执行多个 `sed` 脚本。|
|`-r` / `-E`|**扩展正则 (Extended Regex)**。让你可以使用更现代、更简洁的正则表达式语法（如 `+`, `?`, `|

### 五、实战心法 · 常用组合 (Practical Patterns)

理法合一，方显神通。

- **替换文件中的文本:** `sed -i 's/旧内容/新内容/g' a.txt`
    
- **只打印特定行 (第 5 到 10 行):** `sed -n '5,10p' a.txt`
    
- **删除所有空行:** `sed '/^$/d' a.txt`
    
- **在匹配行后追加内容:** `sed '/error/a \-- CHECK THIS LINE --' log.txt`
    
- **删除所有注释行和空行:** `sed -e '/^#/d' -e '/^$/d' config.conf`
    

> `sed` 的哲学是“过滤”与“转换”。它不与文件本身纠缠，而是在流动的管道中完成改造。掌握它，你便拥有了在命令行中塑造文本形态的力量。